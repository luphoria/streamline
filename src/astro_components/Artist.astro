<div class="musicbrainz-artist">
	<input id="artistMbid" placeholder="e0c97a4d-c392-41a9-a374-57af3e3eeab3" />
	<button id="artistButton">view artist</button>
	<br />
	<release>
		<h3 id="artist-name"></h3>
		<h4 id="artist-disambiguation"></h4>
		<p id="artist-releases"></p>
	</release>
</div>

<script>
	import { MusicBrainz } from "../utils/MusicBrainz";

	const mb = new MusicBrainz("https://musicbrainz.org/ws/2/");
	export const viewArtist = async (mbid) => {
		console.log(`viewArtist: ${mbid}`);

		let artist = await mb.ArtistInfo(mbid);
		console.log(`viewRelease: artist info:`);
		console.log(artist);

		document.getElementById("artist-name").innerText = artist.name;
		document.getElementById("artist-disambiguation").innerText =
			artist.disambiguation;

		document.getElementById("artist-releases").innerHTML = "";

		let resNumber = 0;
		for (let releaseGroup in artist.releaseGroups.all) {
			let group = artist.releaseGroups.all[releaseGroup];
			let releaseGroupHtml = `<span id="release${resNumber}" value="${artist.releaseGroups.all[releaseGroup].mbid}"><b>${group.title}</b> (${group.date}) [${group.type}]</span><br/>`;
			document.getElementById("artist-releases").innerHTML += releaseGroupHtml;
			resNumber += 1;
		}
	};

	document.getElementById("artistButton").addEventListener("click", () => {
		viewArtist(
			(document.getElementById("artistMbid") as HTMLInputElement).value
		);
	});
</script>
